<!DOCTYPE html> 
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->  
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->  
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->  
    <head>
        <title>Panelu Partnera Benefit Systems</title>

        <!-- Meta -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">

        <!-- Favicon -->
        <link rel="shortcut icon" href="favicon.ico">

        <!-- Web Fonts -->
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:400,300,600&amp;subset=cyrillic,latin">

        <!-- CSS Global Compulsory -->
        <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="assets/css/style.css">

        <!-- CSS Header and Footer -->
        <link rel="stylesheet" href="assets/css/headers/header-default.css">
        <link rel="stylesheet" href="assets/css/footers/footer-v1.css">

        <!-- CSS Implementing Plugins -->
        <link rel="stylesheet" href="assets/plugins/animate.css">
        <link rel="stylesheet" href="assets/plugins/line-icons/line-icons.css">
        <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.min.css">

        <!-- CSS Page Style -->    
        <link rel="stylesheet" href="assets/css/pages/shortcode_timeline2.css">

        <link rel="stylesheet" href="assets/css/headers/header-v4.css">

        <!-- CSS Customization -->
        <link rel="stylesheet" href="assets/css/theme-colors/dark-red.css">
        <link rel="stylesheet" href="assets/css/custom.css">

        <link rel="stylesheet" href="assets/plugins/sky-forms-pro/skyforms/css/sky-forms.css">
        <link rel="stylesheet" href="assets/plugins/sky-forms-pro/skyforms/custom/custom-sky-forms.css">

        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.css" />

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/css/bootstrap-select.min.css" />

        <!-- Load c3.css -->
        <link href="assets/css/c3/c3.css" rel="stylesheet" type="text/css">


        <!-- CSS Page Style -->    
        <link rel="stylesheet" href="assets/css/pages/page_invoice.css">


        <!-- DataTables -->
        <link rel="stylesheet" type="text/css" href="assets/plugins/datatable/css/jquery.dataTables.css">

        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.9/css/jquery.dataTables.min.css">


    </head>

    <body>    
        <div class="wrapper">
            <!--=== Header ===-->    
            <div class="header" id="includedContentHeader">
            </div>
            <!--=== End Header ===--> 
            <!--=== Breadcrumbs ===-->
            <div class="breadcrumbs">
                <div class="container">
                    <h1 class="pull-left">Statystyki</h1>
                    <ul class="pull-right breadcrumb">
                        <li><a href="wall.html">Home</a></li>
                        <li><a href="#">Profil</a></li>
                    </ul>
                </div>
            </div><!--/breadcrumbs-->
            <!--=== End Breadcrumbs ===-->

            <!--=== Content Part ===-->
            <div class="container content">     
                <div class="row">
                    <!-- Begin Content -->
                    <div class="col-md-12 margin-bottom-50">
                        <div class="row">
                            <div class="col-md-12 blog">
                                <div class="news-v3-in">
                                    <form action="" id="sky-form" class="sky-form">
                                        <fieldset>
                                            <h4>Wykres dzienny
                                                <br>
                                                <small>ilośc wizyt z dokładnością do godziny</small>
                                            </h4>
                                            <div id="chartDaily"></div>
                                            <h5>Parametry</h5>
                                            <div class="row">
                                                <section class="col col-4">
                                                    <label class="label">Dzień</label>
                                                    <label class="input">
                                                        <i class="icon-append fa fa-calendar"></i>
                                                        <input type="text" name="date" id="date" value="23/12/2015">
                                                    </label>
                                                </section>
                                                <section class="col col-12">
                                                    <label class="label">Obiekty</label>
                                                    <div class="input-group margin-bottom-20">
                                                        <select  id="service-select" class="selectpicker input-block-level" data-live-search="true" data-size="10"  multiple title='Wybierz...' data-selected-text-format="count>1" data-width="100%">
                                                            <option value="330" data-entry="0">(1212) Tyger Gym - Przymorze</option>	
                                                            <option value="332" data-entry="0" selected>(1212) Tyger Gym - Manhattan</option>	
                                                            <option value="332" data-entry="0" selected>(1212) Tyger Gym - Rental Park</option>	
                                                        </select>
                                                        <span class="input-group-btn">
                                                            <button class="btn-u btn-u-dark margin-left-5"  tabindex="-1"  type="button" onclick="deselectAllOptions()"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Odznacz wszystko</button>
                                                        </span>
                                                    </div>
                                                    <label class="label">Usługa</label>
                                                    <div class="input-group margin-bottom-20">
                                                        <select  id="service-select2" class="selectpicker input-block-level" data-live-search="true" data-size="10"  multiple title='Wybierz...' data-selected-text-format="count>3" data-width="100%">
                                                            <optgroup label="(1212) Tyger Gym - Przymorze">
                                                                <option value="330" data-entry="0">joga</option>	
                                                                <option value="332" data-entry="0" selected>basen</option>	
                                                                <option value="333" data-entry="0">aqua aerobik</option>	
                                                                <option value="334" data-entry="2" selected>siłownia</option>	
                                                                <option value="342" data-entry="2" selected>fitness</option>
                                                            </optgroup>
                                                            <optgroup label="(1212) Tyger Gym - Manhattan">
                                                                <option value="335" data-entry="0">sauna</option>	
                                                                <option value="341" data-entry="0">sztuki walki</option>
                                                            </optgroup>
                                                        </select>
                                                        <span class="input-group-btn">
                                                            <button class="btn-u btn-u-dark margin-left-5" type="button" onclick="deselectAllOptions()"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Odznacz wszystko</button>
                                                        </span>
                                                    </div>
                                                </section>
                                                <section class="col col-12 pull-right">
                                                       <a href="#" class="btn-u btn-u-default"> <i class="fa fa-plus fa-file-excel-o"></i> Eksportuj CSV</a> 
                                                        <a href="#" class="btn-u btn-u-dark"> <i class="fa fa-plus fa-file-pdf-o"></i> Eksportuj PNG </a> 
                                                    <a href="#" class="btn-u"> Ustaw</a> 
                                                </section>
                                            </div>
                                        </fieldset>
                                        <fieldset>
                                            <h4>Wykres tygodniowy
                                                <br>
                                                <small>ilośc wizyt z dokładnością do dnia tygodnia</small>
                                            </h4>
                                            <section>
                                                <div id="chartWeekly"></div>
                                                <h5>Parametry</h5>
                                                <div class="row">
                                                    <section class="col col-4">
                                                        <label class="label">Tydzień</label>
                                                        <label class="input">
                                                            <i class="icon-append fa fa-calendar"></i>
                                                            <input type='text' id='weeklyDatePicker' placeholder="Select Week" />
                                                        </label>
                                                    </section>
                                                    <section class="col col-12">
                                                        <label class="label">Obiekty</label>
                                                        <div class="input-group margin-bottom-20">
                                                            <select  id="service-select3" class="selectpicker input-block-level" data-live-search="true" data-size="10"  multiple title='Wybierz...' data-selected-text-format="count>1" data-width="100%">
                                                                <option value="330" data-entry="0">(1212) Tyger Gym - Przymorze</option>	
                                                                <option value="332" data-entry="0" selected>(1212) Tyger Gym - Manhattan</option>	
                                                                <option value="332" data-entry="0" selected>(1212) Tyger Gym - Rental Park</option>	
                                                            </select>
                                                            <span class="input-group-btn">
                                                                <button class="btn-u btn-u-dark margin-left-5"  tabindex="-1"  type="button" onclick="deselectAllOptions()"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Odznacz wszystko</button>
                                                            </span>
                                                        </div>
                                                        <label class="label">Usługa</label>
                                                        <div class="input-group margin-bottom-20">
                                                            <select  id="service-select4" class="selectpicker input-block-level" data-live-search="true" data-size="10"  multiple title='Wybierz...' data-selected-text-format="count>3" data-width="100%">
                                                                <optgroup label="(1212) Tyger Gym - Przymorze">
                                                                    <option value="330" data-entry="0">joga</option>	
                                                                    <option value="332" data-entry="0" selected>basen</option>	
                                                                    <option value="333" data-entry="0">aqua aerobik</option>	
                                                                    <option value="334" data-entry="2" selected>siłownia</option>	
                                                                    <option value="342" data-entry="2" selected>fitness</option>
                                                                </optgroup>
                                                                <optgroup label="(1212) Tyger Gym - Manhattan">
                                                                    <option value="335" data-entry="0">sauna</option>	
                                                                    <option value="341" data-entry="0">sztuki walki</option>
                                                                </optgroup>
                                                            </select>
                                                            <span class="input-group-btn">
                                                                <button class="btn-u btn-u-dark margin-left-5" type="button" onclick="deselectAllOptions()"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Odznacz wszystko</button>
                                                            </span>
                                                        </div>
                                                    </section>
                                                    <section class="col col-12 pull-right">
                                                        <a href="#" class="btn-u btn-u-default"> <i class="fa fa-plus fa-file-excel-o"></i> Eksportuj CSV</a> 
                                                        <a href="#" class="btn-u btn-u-dark"> <i class="fa fa-plus fa-file-pdf-o"></i> Eksportuj PNG </a> 
                                                        <a href="#" class="btn-u"> Ustaw</a> 
                                                    </section>
                                                </div>
                                            </section>
                                        </fieldset>
                                        <fieldset>
                                            <h4>Wykres miesięczny
                                                <br>
                                                <small>ilośc wizyt z dokładnością dnia miesiąca</small>
                                            </h4>
                                            <section>
                                                <div id="chartMonthly"></div>
                                                <div class="row">
                                                    <section class="col col-6 pull-right">
                                                        <table class="table table-striped invoice-table">
                                                            <tbody >
                                                                <tr>
                                                                    <td class="summary summary-text summary-row">ŁĄCZNIE</td>
                                                                    <td class="summary-cell summary-row">325</td>
                                                                    <td class="summary-row"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="summary summary-text">W tym</td>
                                                                    <td class="summary">basen</td>
                                                                    <td class="summary">120</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="no-border"></td>
                                                                    <td class=" summary summary-cell">siłownia</td>
                                                                    <td class="summary">100</td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="no-border"></td>
                                                                    <td class=" summary summary-cell">fitness</td>
                                                                    <td class="summary">105</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </section>
                                                </div>

                                                <h5>Parametry</h5>
                                                <div class="row">
                                                    <section class="col col-4">
                                                        <label class="label">Miesiąc</label>
                                                        <div class="owl-navigation">
                                                            <div class="customNavigation">
                                                                <a id="back" name="back" class="owl-btn prev-v1"><i class="fa fa-angle-left"></i></a>
                                                                <a id="forward" name="forward" class="owl-btn next-v1"><i class="fa fa-angle-right"></i></a>
                                                                <label id="currentMonth">May 2013</label>
                                                            </div>
                                                        </div>
                                                    </section>
                                                    <section class="col col-12">
                                                        <label class="label">Obiekty</label>
                                                        <div class="input-group margin-bottom-20">
                                                            <select  id="service-select5" class="selectpicker input-block-level" data-live-search="true" data-size="10"  multiple title='Wybierz...' data-selected-text-format="count>1" data-width="100%">
                                                                <option value="330" data-entry="0">(1212) Tyger Gym - Przymorze</option>	
                                                                <option value="332" data-entry="0" selected>(1212) Tyger Gym - Manhattan</option>	
                                                                <option value="332" data-entry="0" selected>(1212) Tyger Gym - Rental Park</option>	
                                                            </select>
                                                            <span class="input-group-btn">
                                                                <button class="btn-u btn-u-dark margin-left-5"  tabindex="-1"  type="button" onclick="deselectAllOptions()"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Odznacz wszystko</button>
                                                            </span>
                                                        </div>
                                                        <label class="label">Usługa</label>
                                                        <div class="input-group margin-bottom-20">
                                                            <select  id="service-select6" class="selectpicker input-block-level" data-live-search="true" data-size="10"  multiple title='Wybierz...' data-selected-text-format="count>3" data-width="100%">
                                                                <optgroup label="(1212) Tyger Gym - Przymorze">
                                                                    <option value="330" data-entry="0">joga</option>	
                                                                    <option value="332" data-entry="0" selected>basen</option>	
                                                                    <option value="333" data-entry="0">aqua aerobik</option>	
                                                                    <option value="334" data-entry="2" selected>siłownia</option>	
                                                                    <option value="342" data-entry="2" selected>fitness</option>
                                                                </optgroup>
                                                                <optgroup label="(1212) Tyger Gym - Manhattan">
                                                                    <option value="335" data-entry="0">sauna</option>	
                                                                    <option value="341" data-entry="0">sztuki walki</option>
                                                                </optgroup>
                                                            </select>
                                                            <span class="input-group-btn">
                                                                <button class="btn-u btn-u-dark margin-left-5" type="button" onclick="deselectAllOptions()"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Odznacz wszystko</button>
                                                            </span>
                                                        </div>
                                                    </section>
                                                    <section class="col col-12 pull-right">
                                                           <a href="#" class="btn-u btn-u-default"> <i class="fa fa-plus fa-file-excel-o"></i> Eksportuj CSV</a> 
                                                        <a href="#" class="btn-u btn-u-dark"> <i class="fa fa-plus fa-file-pdf-o"></i> Eksportuj PNG </a> 
                                                        <a href="#" class="btn-u"> Ustaw</a> 
                                                    </section>
                                                </div>
                                            </section>
                                        </fieldset>
                                    </form>        
                                </div>
                            </div>
                        </div><!--/row-->   
                    </div>
                    <!-- End Content -->
                    <!-- Begin Sidebar Menu -->
                    <div class="col-md-3" id="includedContentSideBar">
                    </div>
                    <!-- End Sidebar Menu -->
                </div>          
            </div><!--/container-->     
            <!--=== End Content Part ===-->

        </div><!--/End Wrapepr-->
        <!--=== Footer Version 1 ===-->
        <div class="footer-v1" id="includedContentFooter">
        </div>     
        <!--=== End Footer Version 1 ===-->
        <!-- JS Global Compulsory -->           
        <script type="text/javascript" src="assets/plugins/jquery/jquery.min.js"></script>
        <script type="text/javascript" src="assets/plugins/jquery/jquery-migrate.min.js"></script>
        <script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
        <!-- JS Implementing Plugins -->
        <script type="text/javascript" src="assets/plugins/back-to-top.js"></script>
        <script type="text/javascript" src="assets/plugins/smoothScroll.js"></script>
        <!-- JS Customization -->
        <script type="text/javascript" src="assets/js/custom.js"></script>
        <!-- JS Page Level -->           
        <script type="text/javascript" src="assets/js/app.js"></script>


        <script type="text/javascript" src="assets/js/plugins/validation.js"></script>
        <script type="text/javascript" src="assets/js/jquery.timepicker.js"></script>

        <!-- Load d3.js and c3.js -->
        <script src="assets/js/plugins/d3/d3.min.js" charset="utf-8"></script>
        <script src="assets/js/plugins/c3/c3.min.js"></script>

        <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/js/bootstrap-select.min.js"></script>
        <script src="https://cdn.jsdelivr.net/momentjs/2.10.6/moment.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/bootstrap.datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script>

        <script type="text/javascript">
                                                                    jQuery(document).ready(function () {
                                                                        App.init();


                                                                    });</script>
        <script>
            $(function () {
                $("#includedContentHeader").load("header.html");
                $("#includedContentFooter").load("footer.html");
                var chartDaily = c3.generate({
                    bindto: '#chartDaily',
                    data: {
                        x: 'x',
                        xFormat: '%Y',
                        columns: [
                            ['x', '9', '10', '11', '12', '13', '14'],
                            ['basen', 30, 200, 400, 650, 250],
                            ['siłownia', 130, 100, 100, 200, 150, 50],
                            ['fitness', 230, 200, 200, 300, 250, 250]
                        ],
                        type: 'bar',
                        labels: true,
                        groups: [
                            ['basen', 'siłownia', 'fitness']
                        ]
                    },
                    axis: {
                        rotated: true,
                        x: {
                            label:
                                    {
                                        text: 'Godzina',
                                        position: 'outer-middle'

                                    },
                            tick: {
                                format: function (x) {
                                    return x + ':00';
                                }
                            }
                        },
                        y: {
                            label: 'Ilość wizyt'
                        }
                    },
                    grid: {
                        y: {
                            lines: [{value: 0}]
                        }
                    }
                });

                var chartWeekly = c3.generate({
                    bindto: '#chartWeekly',
                    data: {
                        x: 'x',
                        xFormat: '%Y',
                        columns: [
                            ['x', '1', '2', '3', '4', '5', '6', '7'],
                            ['basen', 30, 200, 400, 650, 250, 213],
                            ['siłownia', 130, 100, 100, 200, 150, 50, 321],
                            ['fitness', 230, 200, 200, 300, 250, 250]
                        ],
                        type: 'bar',
                        labels: true,
                        groups: [
                            ['basen', 'siłownia', 'fitness']
                        ]
                    },
                    axis: {
                        x: {
                            label:
                                    {
                                        text: 'Dzień tygodnia',
                                        position: 'outer-middle'

                                    },
                            tick: {
                                format: function (x) {
                                    return x
                                }
                            }
                        },
                        y: {
                            label: 'Ilość wizyt'
                        }
                    },
                    grid: {
                        y: {
                            lines: [{value: 0}]
                        }
                    }
                });

                $("#date").datetimepicker({
                    format: 'MM-DD-YYYY'
                });


                $("#weeklyDatePicker").datetimepicker({
                    format: 'MM-DD-YYYY'
                });

                //Get the value of Start and End of Week
                $('#weeklyDatePicker').on('dp.change', function (e) {
                    var value = $("#weeklyDatePicker").val();
                    var firstDate = moment(value, "MM-DD-YYYY").day(0).format("MM-DD-YYYY");
                    var lastDate = moment(value, "MM-DD-YYYY").day(6).format("MM-DD-YYYY");
                    $("#weeklyDatePicker").val(firstDate + " - " + lastDate);
                });


                setTimeout(function () {
                    $('.dropdown-toggle').dropdown();
                }, 2000);
            });
        </script> 

        <script type="text/javascript">


            // Revealing module pattern to store some global data that will be shared between different functions.
            var d3CalendarGlobals = function () {
                var skyFormWidth = $("#chartMonthly").parent().width();

                var calendarWidth = skyFormWidth,
                        calendarHeight = 0.6 * skyFormWidth,
                        gridXTranslation = 10,
                        gridYTranslation = 40,
                        cellColorForCurrentMonth = '#cccccc',
                        cellColorForPreviousMonth = '#FFFFFF',
                        counter = 0, // Counter is used to keep track of the number of "back" and "forward" button presses and to calculate the month to display.
                        currentMonth = new Date().getMonth(),
                        publicGetCurrentDate = new Date().getDate(),
                        monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                        datesGroup;

                function publicCalendarWidth() {
                    return calendarWidth;
                }
                function publicCalendarHeight() {
                    return calendarHeight;
                }
                function publicGridXTranslation() {
                    return gridXTranslation;
                }
                function publicGridYTranslation() {
                    return gridYTranslation;
                }
                function publicGridWidth() {
                    return calendarWidth - 10;
                }
                function publicGridHeight() {
                    return calendarHeight - 40;
                }
                function publicCellWidth() {
                    return publicGridWidth() / 7;
                }
                function publicCellHeight() {
                    return publicGridHeight() / 5;
                }
                function publicGetDatesGroup() {
                    return datesGroup;
                }
                function publicSetDatesGroup(value) {
                    datesGroup = value;
                }
                function publicIncrementCounter() {
                    counter = counter + 1;
                }
                function publicDecrementCounter() {
                    counter = counter - 1;
                }
                function publicGetCounter() {
                    return counter;
                }
                function publicMonthToDisplay() {
                    var dateToDisplay = new Date();
                    // We use the counter that keep tracks of "back" and "forward" presses to get the month to display.
                    dateToDisplay.setMonth(currentMonth + counter);
                    return dateToDisplay.getMonth();
                }
                function publicMonthToDisplayAsText() {
                    return monthNames[publicMonthToDisplay()];
                }
                function publicYearToDisplay() {
                    var dateToDisplay = new Date();
                    // We use the counter that keep tracks of "back" and "forward" presses to get the year to display.
                    dateToDisplay.setMonth(currentMonth + counter);
                    return dateToDisplay.getFullYear();
                }
                function publicGridCellPositions() {

                    // We store the top left positions of a 7 by 5 grid. These positions will be our reference points for drawing
                    // various objects such as the rectangular grids, the text indicating the date etc.
                    var cellPositions = [];
                    for (y = 0; y < 5; y++) {
                        for (x = 0; x < 7; x++) {
                            cellPositions.push([x * publicCellWidth(), y * publicCellHeight()]);
                        }
                    }

                    return cellPositions;
                }

                // This function generates all the days of the month. But since we have a 7 by 5 grid, we also need to get some of
                // the days from the previous month and the next month. This way our grid will have all its cells filled. The days
                // from the previous or the next month will have a different color though. 
                function publicDaysInMonth() {
                    var daysArray = [];

                    var firstDayOfTheWeek = new Date(publicYearToDisplay(), publicMonthToDisplay(), 1).getDay();
                    var daysInPreviousMonth = new Date(publicYearToDisplay(), publicMonthToDisplay(), 0).getDate();

                    // Lets say the first week of the current month is a Wednesday. Then we need to get 3 days from 
                    // the end of the previous month. But we can't naively go from 29 - 31. We have to do it properly
                    // depending on whether the last month was one that had 31 days, 30 days or 28.
                    for (i = 1; i <= firstDayOfTheWeek; i++) {
                        daysArray.push([daysInPreviousMonth - firstDayOfTheWeek + i, cellColorForCurrentMonth]);
                    }

                    // These are all the days in the current month.
                    var daysInMonth = new Date(publicYearToDisplay(), publicMonthToDisplay() + 1, 0).getDate();
                    for (i = 1; i <= daysInMonth; i++) {
                        daysArray.push([i, cellColorForPreviousMonth]);
                    }

                    // Depending on how many days we have so far (from previous month and current), we will need
                    // to get some days from next month. We can do this naively though, since all months start on
                    // the 1st.
                    var daysRequiredFromNextMonth = 35 - daysArray.length;

                    for (i = 1; i <= daysRequiredFromNextMonth; i++) {
                        daysArray.push([i, cellColorForCurrentMonth]);
                    }

                    return daysArray.slice(0, 35);
                }

                return {
                    calendarWidth: publicCalendarWidth(),
                    calendarHeight: publicCalendarHeight(),
                    gridXTranslation: publicGridXTranslation(),
                    gridYTranslation: publicGridYTranslation(),
                    gridWidth: publicGridWidth(),
                    gridHeight: publicGridHeight(),
                    cellWidth: publicCellWidth(),
                    cellHeight: publicCellHeight(),
                    getDatesGroup: publicGetDatesGroup,
                    setDatesGroup: publicSetDatesGroup,
                    incrementCounter: publicIncrementCounter,
                    decrementCounter: publicDecrementCounter,
                    getCounter: publicGetCounter,
                    monthToDisplay: publicMonthToDisplay(),
                    monthToDisplayAsText: publicMonthToDisplayAsText,
                    yearToDisplay: publicYearToDisplay,
                    gridCellPositions: publicGridCellPositions(),
                    daysInMonth: publicDaysInMonth,
                    currentDay: publicGetCurrentDate,
                }
            }();

            $(document).ready(function () {
                renderCalendarGrid();
                renderDaysOfMonth();
                $('#back').click(displayPreviousMonth);
                $('#forward').click(displayNextMonth);
            }
            );

            function displayPreviousMonth() {
                // We keep track of user's "back" and "forward" presses in this counter
                d3CalendarGlobals.decrementCounter();
                renderDaysOfMonth();
            }

            function displayNextMonth() {
                // We keep track of user's "back" and "forward" presses in this counter
                d3CalendarGlobals.incrementCounter();
                renderDaysOfMonth();
            }

            // This function is responsible for rendering the days of the month in the grid.
            function renderDaysOfMonth(month, year) {
                $('#currentMonth').text(d3CalendarGlobals.monthToDisplayAsText() + ' ' + d3CalendarGlobals.yearToDisplay());
                // We get the days for the month we need to display based on the number of times the user has pressed
                // the forward or backward button.
                var daysInMonthToDisplay = d3CalendarGlobals.daysInMonth();
                var cellPositions = d3CalendarGlobals.gridCellPositions;

                // All text elements representing the dates in the month are grouped together in the "datesGroup" element by the initalizing
                // function below. The initializing function is also responsible for drawing the rectangles that make up the grid.
                d3CalendarGlobals.datesGroup
                        .selectAll("text")
                        .data(daysInMonthToDisplay)
                        .attr("x", function (d, i) {
                            return cellPositions[i][0];
                        })
                        .attr("y", function (d, i) {
                            return cellPositions[i][1];
                        })
                        .attr("dx", 20) // right padding
                        .attr("dy", 20) // vertical alignment : middle
                        .attr("transform", "translate(" + d3CalendarGlobals.gridXTranslation + "," + d3CalendarGlobals.gridYTranslation + ")")
                        .text(function (d) {
                            return d[0];
                        }); // Render text for the day of the week

                d3CalendarGlobals.calendar
                        .selectAll("rect")
                        .data(daysInMonthToDisplay)
                        // Here we change the color depending on whether the day is in the current month, the previous month or the next month.
                        // The function that generates the dates for any given month will also specify the colors for days that are not part of the
                        // current month. We just have to use it to fill the rectangle
                        .style("fill", function (d) {
                            return d[1];
                        });

                drawGraphsForMonthlyData();

            }

            function drawGraphsForMonthlyData() {
                // Get some random data
                var data = getDataForMonth();
                // Set up variables required to draw a pie chart
                var outerRadius = d3CalendarGlobals.cellWidth / 3;
                var innerRadius = 0;
                var pie = d3.layout.pie();
                var color = d3.scale.category10();
                var arc = d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius);

                // We need to index and group the pie charts and slices generated so that they can be rendered in
                // the appropriate cells. To do that, we call D3's 'pie' function of each of the data elements.
                var indexedPieData = [];
                for (i = 0; i < data.length; i++) {
                    var pieSlices = pie(data[i]);
                    // This loop is to store an index (j) for each of the slices of a given pie chart. Two different charts
                    // on two different days will have the the same set of numbers for slices (eg: 0,1,2). This will help us
                    // pick the same colors for the slices for two independent charts. Otherwise, the colors of the slices
                    // will be different each day.
                    for (j = 0; j < pieSlices.length; j++) {
                        indexedPieData.push([pieSlices[j], i, j]);
                    }
                }

                var cellPositions = d3CalendarGlobals.gridCellPositions;

                d3CalendarGlobals.chartsGroup
                        .selectAll("g.arc")
                        .remove();

                var arcs = d3CalendarGlobals.chartsGroup.selectAll("g.arc")
                        // use the indexed data so that each pie chart can be draw in a different cell and therefore for a different day
                        .data(indexedPieData)
                        .enter()
                        .append("g")
                        .attr("class", "arc")
                        .attr("transform", function (d) {
                            // This is where we use the index here to translate the pie chart and rendere it in the appropriate cell. 
                            // Normally, the chart would be squashed up against the top left of the cell, obscuring the text that shows the day of the month.
                            // We use the gridXTranslation and gridYTranslation and multiply it by a factor to move it to the center of the cell. There is probably
                            // a better way of doing this though.
                            var currentDataIndex = d[1];
                            return "translate(" + (outerRadius + d3CalendarGlobals.gridXTranslation * 5 + cellPositions[currentDataIndex][0]) + ", " + (outerRadius + d3CalendarGlobals.gridYTranslation * 1.25 + cellPositions[currentDataIndex][1]) + ")";
                        });

                arcs.append("path")
                        .attr("fill", function (d, i) {
                            // The color is generated using the second index. Each slice of the pie is given a fixed number. This applies to all charts (see the indexing loop above).
                            // This way, by using the index we can generate teh same colors for each of the slices for different charts on different days.
                            return color(d[2]);
                        })
                        .attr("d", function (d, i) {
                            // Standard functions for drawing a pie charts in D3.
                            return arc(d[0]);
                        });

                arcs.append("text")
                        .attr("transform", function (d, i) {
                            // Standard functions for drawing a pie charts in D3.
                            return "translate(" + arc.centroid(d[0]) + ")";
                        })
                        .attr("text-anchor", "middle")
                        .text(function (d, i) {
                            return d[0].value;
                        });
            }

            // Generates some random data that can be used to draw pie charts.
            function getDataForMonth() {
                var daysInMonthToDisplay = d3CalendarGlobals.daysInMonth();
                var randomData = [];
                for (var i = 0; i < 35; i++) {
                    var currentCell = daysInMonthToDisplay[i];
                    console.log(d3CalendarGlobals.getCounter());
                    if (currentCell[1] != "#FFFFFF" || (d3CalendarGlobals.getCounter() > 0) || ((d3CalendarGlobals.getCounter() == 0) && (currentCell[0] > d3CalendarGlobals.currentDay))) {
                        randomData.push([]);
                    } else {
                        randomData.push([Math.floor(Math.random() * 100), Math.floor(Math.random() * 100), Math.floor(Math.random() * 100)]);
                    }
                }
                return randomData;
            }

            // This is the initializing function. It adds an svg element, draws a set of rectangles to form the calendar grid,
            // puts text in each cell representing the date and does the initial rendering of the pie charts.
            function renderCalendarGrid(month, year) {

                // Add the svg element.
                d3CalendarGlobals.calendar = d3.select("#chartMonthly")
                        .append("svg")
                        .attr("class", "calendar")
                        .attr("width", d3CalendarGlobals.calendarWidth)
                        .attr("height", d3CalendarGlobals.calendarHeight)
                        .append("g");

                // Cell positions are generated and stored globally because they are used by other functions as a reference to render different things.
                var cellPositions = d3CalendarGlobals.gridCellPositions;

                // Draw rectangles at the appropriate postions, starting from the top left corner. Since we want to leave some room for the heading and buttons,
                // use the gridXTranslation and gridYTranslation variables.
                d3CalendarGlobals.calendar.selectAll("rect")
                        .data(cellPositions)
                        .enter()
                        .append("rect")
                        .attr("x", function (d) {
                            return d[0];
                        })
                        .attr("y", function (d) {
                            return d[1];
                        })
                        .attr("width", d3CalendarGlobals.cellWidth)
                        .attr("height", d3CalendarGlobals.cellHeight)
                        .style("stroke", "#555")
                        .style("fill", "white")
                        .attr("transform", "translate(" + d3CalendarGlobals.gridXTranslation + "," + d3CalendarGlobals.gridYTranslation + ")");

                var daysOfTheWeek = ["Niedziela", "Poniedziałek", "Wtorek", "Środa", "Czwartek", "Piatek", "Sobota"];
                // This adds the day of the week headings on top of the grid
                d3CalendarGlobals.calendar.selectAll("headers")
                        .data([0, 1, 2, 3, 4, 5, 6])
                        .enter().append("text")
                        .attr("x", function (d) {
                            return cellPositions[d][0];
                        })
                        .attr("y", function (d) {
                            return cellPositions[d][1];
                        })
                        .attr("dx", d3CalendarGlobals.gridXTranslation + 5) // right padding
                        .attr("dy", 30) // vertical alignment : middle
                        .text(function (d) {
                            return daysOfTheWeek[d]
                        });

                // The intial rendering of the dates for the current mont inside each of the cells in the grid. We create a named group ("datesGroup"),
                // and add our dates to this group. This group is also stored globally. Later on, when the the user presses the back and forward buttons
                // to navigate between the months, we clear and re add the new text elements to this group
                d3CalendarGlobals.datesGroup = d3CalendarGlobals.calendar.append("svg:g");
                var daysInMonthToDisplay = d3CalendarGlobals.daysInMonth();
                d3CalendarGlobals.datesGroup
                        .selectAll("daysText")
                        .data(daysInMonthToDisplay)
                        .enter()
                        .append("text")
                        .attr("x", function (d, i) {
                            return cellPositions[i][0];
                        })
                        .attr("y", function (d, i) {
                            return cellPositions[i][1];
                        })
                        .attr("dx", 20) // right padding
                        .attr("dy", 20) // vertical alignment : middle
                        .attr("transform", "translate(" + d3CalendarGlobals.gridXTranslation + "," + d3CalendarGlobals.gridYTranslation + ")")
                        .text(function (d) {
                            return d[0];
                        });

                // Create a new svg group to store the chart elements and store it globally. Again, as the user navigates through the months by pressing 
                // the "back" and "forward" buttons on the page, we clear the chart elements from this group and re add them again.
                d3CalendarGlobals.chartsGroup = d3CalendarGlobals.calendar.append("svg:g");
                // Call the function to draw the charts in the cells. This will be called again each time the user presses the forward or backward buttons.
                drawGraphsForMonthlyData();
            }


        </script>

        <!--[if lt IE 9]>
            <script src="assets/plugins/respond.js"></script>
            <script src="assets/plugins/html5shiv.js"></script>
            <script src="assets/plugins/placeholder-IE-fixes.js"></script>
        <![endif]-->

    </body>
</html> 